<!DOCTYPE html>
<html>
<head>
  <title>CAS Dashboard Chatbot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; padding: 20px; }
    #chatbox { max-width: 400px; }
    input, button { padding: 10px; width: 100%; margin-top: 5px; }
    #response { margin-top: 10px; background: #f1f3f4; padding: 10px; border-radius: 6px; }
  </style>
</head>
<body>

<div id="chatbox">
  <h3>üìä CAS Assistant</h3>
  <input type="text" id="question" placeholder="Ask something...">
  <button onclick="ask()">Ask</button>
  <div id="response">Answer will appear here...</div>
</div>

<script>
const SHEET_ID = "15nVPABd1lsP507CQeBDyJRrm2qDeiBPE1PeVu_x255s";
const API_KEY = "AIzaSyA9hwrryLxGH9OMSCcnGUNaaxAIfn9t_yE";

async function ask() {
  const responseBox = document.getElementById("response");
  const userInput = document.getElementById("question").value.trim().toLowerCase();

  if (!userInput) {
    responseBox.innerText = "‚ö†Ô∏è Please enter a question.";
    return;
  }

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Sheet1?key=${API_KEY}`;

  try {
    const res = await fetch(url);

    if (!res.ok) {
      throw new Error("API request failed");
    }

    const data = await res.json();

    if (!data.values) {
      responseBox.innerText = "‚ö†Ô∏è No data found in sheet.";
      return;
    }

    const rows = data.values;
    let found = "‚ùå Answer not found.";

    for (let i = 1; i < rows.length; i++) {
      const question = rows[i][0]?.toLowerCase() || "";
      if (userInput.includes(question) || question.includes(userInput)) {
        found = rows[i][1] || "No answer available.";
        break;
      }
    }

    responseBox.innerText = found;

  } catch (error) {
    console.error("Error:", error);
    responseBox.innerText = "‚ö†Ô∏è Error fetching data. Check API key or console.";
  }
}
</script>

</body>
</html>
