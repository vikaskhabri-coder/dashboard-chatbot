<script>
const SHEET_ID = "15nVPABd1lsP507CQeBDyJRrm2qDeiBPE1PeVu_x255s";
const API_KEY = "AIzaSyDKyXXtT_zjJmzt83Gyok9L6CMCHTkwU1A";

async function ask() {
  let userInput = document.getElementById("question").value.toLowerCase();
  const responseBox = document.getElementById("response");

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Sheet1?key=${API_KEY}`;

  try {
    const res = await fetch(url);
    const data = await res.json();
    console.log("API Response:", data);

    if (!data.values) {
      responseBox.innerText = "⚠️ API returned no data.";
      return;
    }

    const rows = data.values;
    let found = "❌ Answer not found.";

   for (let i = 1; i < rows.length; i++) {
  const question = rows[i][0].toLowerCase();

  // Check both directions for flexible matching
  if (
    userInput.includes(question) ||
    question.includes(userInput)
  ) {
    found = rows[i][1];
    break;
  }
}

    responseBox.innerText = found;

  } catch (error) {
    console.error(error);
    responseBox.innerText = "⚠️ Error occurred. Check console.";
  }
}
</script>
