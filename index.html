<!DOCTYPE html>
<html lang="en">
<head>
  <title>CAS Dashboard Chatbot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f0f1a;
      --surface: #1a1a2e;
      --card: #16213e;
      --border: rgba(255,255,255,0.08);
      --accent1: #7c3aed;
      --accent2: #06b6d4;
      --accent-grad: linear-gradient(135deg, #7c3aed, #06b6d4);
      --text: #e2e8f0;
      --text-muted: #94a3b8;
      --user-bubble: linear-gradient(135deg, #7c3aed, #5b21b6);
      --bot-bubble: #1e293b;
      --input-bg: #0f172a;
      --shadow: 0 25px 60px rgba(0,0,0,0.5);
    }
    body.light {
      --bg: #f0f4ff;
      --surface: #ffffff;
      --card: #f8faff;
      --border: rgba(0,0,0,0.1);
      --text: #1e293b;
      --text-muted: #64748b;
      --bot-bubble: #e2e8f8;
      --input-bg: #f1f5f9;
      --shadow: 0 25px 60px rgba(100,100,200,0.18);
    }
    body, body * { transition: background-color 0.3s, color 0.3s, border-color 0.3s; }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'DM Sans', sans-serif;
      min-height: 100vh;
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(124,58,237,0.15) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(6,182,212,0.12) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    /* Demo page text */
    .demo-page {
      text-align: center;
      color: var(--text);
      z-index: 1;
      padding: 20px;
    }
    .demo-page h1 {
      font-family: 'Sora', sans-serif;
      font-size: 2rem;
      background: var(--accent-grad);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 12px;
    }
    .demo-page p { color: var(--text-muted); font-size: 15px; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FLOATING WIDGET BUTTON
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #chat-fab {
      position: fixed;
      bottom: 28px;
      right: 28px;
      width: 62px;
      height: 62px;
      border-radius: 50%;
      background: var(--accent-grad);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      box-shadow: 0 8px 30px rgba(124,58,237,0.5);
      z-index: 999;
      transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1), opacity 0.3s;
      animation: fabIn 0.5s 0.3s cubic-bezier(0.34,1.56,0.64,1) both;
    }
    @keyframes fabIn {
      from { transform: scale(0); opacity: 0; }
      to   { transform: scale(1); opacity: 1; }
    }
    #chat-fab:hover { transform: scale(1.12); }

    /* Notification badge */
    #chat-fab .badge {
      position: absolute;
      top: -2px; right: -2px;
      width: 18px; height: 18px;
      background: #ef4444;
      border-radius: 50%;
      border: 2px solid var(--bg, #0f0f1a);
      font-size: 10px;
      color: white;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700;
      animation: badgePop 0.3s cubic-bezier(0.34,1.56,0.64,1);
    }
    @keyframes badgePop {
      from { transform: scale(0); }
      to   { transform: scale(1); }
    }
    .badge.hidden { display: none; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CHAT WINDOW
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #chatbox {
      position: fixed;
      bottom: 104px;
      right: 28px;
      width: 400px;
      max-width: calc(100vw - 40px);
      border-radius: 28px;
      overflow: hidden;
      box-shadow: var(--shadow);
      background: var(--surface);
      border: 1px solid var(--border);
      z-index: 998;
      transform: scale(0.85) translateY(30px);
      opacity: 0;
      pointer-events: none;
      transform-origin: bottom right;
      transition: transform 0.35s cubic-bezier(0.34,1.56,0.64,1), opacity 0.3s;
    }
    #chatbox.open {
      transform: scale(1) translateY(0);
      opacity: 1;
      pointer-events: all;
    }

    /* â”€â”€ Header â”€â”€ */
    #chat-header {
      background: var(--accent-grad);
      padding: 18px 16px 14px;
      position: relative;
      overflow: hidden;
    }
    #chat-header::after {
      content: '';
      position: absolute;
      bottom: -20px; right: -20px;
      width: 110px; height: 110px;
      border-radius: 50%;
      background: rgba(255,255,255,0.06);
    }
    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .header-left { display: flex; align-items: center; gap: 12px; }
    .avatar-wrap {
      width: 48px; height: 48px;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      border: 2px solid rgba(255,255,255,0.3);
      display: flex; align-items: center; justify-content: center;
      font-size: 24px;
      position: relative;
    }
    .status-dot {
      position: absolute;
      bottom: 1px; right: 1px;
      width: 11px; height: 11px;
      background: #22c55e;
      border-radius: 50%;
      border: 2px solid white;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); opacity: 0.7; }
    }
    .header-info h3 {
      font-family: 'Sora', sans-serif;
      font-size: 16px;
      font-weight: 700;
      color: white;
    }
    .header-info p { font-size: 11px; color: rgba(255,255,255,0.75); margin-top: 2px; }
    .header-actions { display: flex; gap: 6px; }
    .icon-btn {
      width: 32px; height: 32px;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.2);
      color: white;
      font-size: 14px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.2s, transform 0.2s;
    }
    .icon-btn:hover { background: rgba(255,255,255,0.28); transform: scale(1.1); }

    /* Category tabs */
    .category-tabs {
      display: flex;
      gap: 6px;
      margin-top: 12px;
      overflow-x: auto;
      padding-bottom: 2px;
    }
    .category-tabs::-webkit-scrollbar { display: none; }
    .tab-btn {
      padding: 4px 12px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.1);
      color: rgba(255,255,255,0.85);
      font-size: 11px;
      font-family: 'DM Sans', sans-serif;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }
    .tab-btn:hover, .tab-btn.active {
      background: rgba(255,255,255,0.25);
      color: white;
    }

    /* â”€â”€ Messages â”€â”€ */
    #chat-messages {
      height: 280px;
      overflow-y: auto;
      padding: 16px 14px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: var(--card);
      scroll-behavior: smooth;
    }
    #chat-messages::-webkit-scrollbar { width: 4px; }
    #chat-messages::-webkit-scrollbar-thumb { background: var(--accent1); border-radius: 10px; }

    .msg-row {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      animation: msgIn 0.35s cubic-bezier(0.34,1.56,0.64,1) both;
    }
    @keyframes msgIn {
      from { opacity: 0; transform: translateY(14px) scale(0.95); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }
    .msg-row.user { flex-direction: row-reverse; }

    .msg-avatar {
      width: 30px; height: 30px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 14px;
      flex-shrink: 0;
      border: 2px solid var(--border);
    }
    .msg-avatar.bot-av { background: var(--accent-grad); }
    .msg-avatar.user-av { background: rgba(124,58,237,0.2); }

    .bubble-wrap { max-width: 78%; }

    .bubble {
      padding: 10px 14px;
      border-radius: 18px;
      font-size: 13.5px;
      line-height: 1.55;
    }
    .bubble.bot {
      background: var(--bot-bubble);
      color: var(--text);
      border-bottom-left-radius: 4px;
    }
    .bubble.user {
      background: var(--user-bubble);
      color: white;
      border-bottom-right-radius: 4px;
    }

    /* Bubble actions (feedback + copy) */
    .bubble-actions {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 5px;
    }
    .bubble-time {
      font-size: 10px;
      color: var(--text-muted);
      flex: 1;
    }
    .msg-row.user .bubble-actions { justify-content: flex-end; }

    .action-btn {
      width: 24px; height: 24px;
      border-radius: 6px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 13px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.2s, transform 0.15s;
    }
    .action-btn:hover { background: var(--border); transform: scale(1.15); }
    .action-btn.liked { color: #22c55e; }
    .action-btn.disliked { color: #ef4444; }
    .action-btn.copied { color: var(--accent2); }

    /* Typing indicator */
    .typing-bubble {
      background: var(--bot-bubble);
      padding: 13px 16px;
      border-radius: 18px;
      border-bottom-left-radius: 4px;
      display: flex;
      gap: 5px;
      align-items: center;
    }
    .typing-bubble span {
      width: 6px; height: 6px;
      background: var(--text-muted);
      border-radius: 50%;
      animation: bounce 1.2s infinite;
    }
    .typing-bubble span:nth-child(2) { animation-delay: 0.2s; }
    .typing-bubble span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-6px); }
    }

    /* â”€â”€ Input Area â”€â”€ */
    #input-area {
      padding: 12px 14px;
      background: var(--surface);
      border-top: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .mic-btn {
      width: 38px; height: 38px;
      border-radius: 50%;
      border: 1.5px solid var(--border);
      background: var(--input-bg);
      color: var(--text-muted);
      font-size: 16px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s;
    }
    .mic-btn:hover { border-color: var(--accent1); color: var(--accent1); }
    .mic-btn.listening {
      background: rgba(239,68,68,0.15);
      border-color: #ef4444;
      color: #ef4444;
      animation: micPulse 1s infinite;
    }
    @keyframes micPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(239,68,68,0.4); }
      50% { box-shadow: 0 0 0 8px rgba(239,68,68,0); }
    }
    #question {
      flex: 1;
      padding: 10px 14px;
      border-radius: 22px;
      border: 1.5px solid var(--border);
      background: var(--input-bg);
      color: var(--text);
      font-size: 13px;
      font-family: 'DM Sans', sans-serif;
      outline: none;
      transition: border 0.2s;
    }
    #question::placeholder { color: var(--text-muted); }
    #question:focus { border-color: var(--accent1); }
    #ask-btn {
      width: 38px; height: 38px;
      border-radius: 50%;
      border: none;
      background: var(--accent-grad);
      color: white;
      font-size: 16px;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      transition: transform 0.2s, opacity 0.2s;
      box-shadow: 0 4px 14px rgba(124,58,237,0.4);
    }
    #ask-btn:hover { transform: scale(1.1); }
    #ask-btn:active { transform: scale(0.95); }

    /* â”€â”€ Footer â”€â”€ */
    #chat-footer {
      padding: 8px 14px 12px;
      background: var(--surface);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    #clear-btn {
      padding: 6px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-muted);
      font-size: 11px;
      font-family: 'DM Sans', sans-serif;
      cursor: pointer;
      transition: all 0.2s;
    }
    #clear-btn:hover { background: rgba(239,68,68,0.1); color: #ef4444; border-color: rgba(239,68,68,0.3); }
    .powered-by { font-size: 10px; color: var(--text-muted); }
    .powered-by span { color: var(--accent1); font-weight: 600; }

    /* Toast notification */
    #toast {
      position: fixed;
      bottom: 110px;
      right: 28px;
      background: #1e293b;
      color: #e2e8f0;
      padding: 10px 18px;
      border-radius: 12px;
      font-size: 13px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      z-index: 1000;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s;
      pointer-events: none;
      border-left: 3px solid var(--accent1);
    }
    #toast.show { opacity: 1; transform: translateY(0); }
  </style>
</head>
<body>

<!-- Demo page background content -->
<div class="demo-page">
  <h1>CAS Dashboard</h1>
  <p>Click the ğŸ’¬ button in the bottom-right corner to open the chatbot!</p>
</div>

<!-- Toast notification -->
<div id="toast">âœ… Copied to clipboard!</div>

<!-- Floating Action Button -->
<button id="chat-fab" onclick="toggleChat()">
  ğŸ’¬
  <div class="badge hidden" id="notif-badge">1</div>
</button>

<!-- Chat Window -->
<div id="chatbox">

  <!-- Header -->
  <div id="chat-header">
    <div class="header-top">
      <div class="header-left">
        <div class="avatar-wrap">
          ğŸ¤–
          <div class="status-dot"></div>
        </div>
        <div class="header-info">
          <h3>CAS Assistant</h3>
          <p>ğŸŸ¢ Online Â· Always ready to help</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="icon-btn" onclick="toggleDark()" id="theme-btn" title="Toggle Theme">ğŸŒ™</button>
        <button class="icon-btn" onclick="toggleChat()" title="Close">âœ•</button>
      </div>
    </div>

    <!-- Category Tabs -->
    <div class="category-tabs">
      <button class="tab-btn active" onclick="setCategory(this, 'Sheet1')">ğŸ“Š General</button>
      <button class="tab-btn" onclick="setCategory(this, 'Sheet4')">ğŸ› ï¸ Support</button>
    </div>
  </div>

  <!-- Messages -->
  <div id="chat-messages"></div>

  <!-- Input -->
  <div id="input-area">
    <button class="mic-btn" id="mic-btn" onclick="toggleVoice()" title="Voice Input">ğŸ¤</button>
    <input type="text" id="question" placeholder="Ask something..." onkeydown="if(event.key==='Enter') ask()">
    <button id="ask-btn" onclick="ask()" title="Send">â¤</button>
  </div>

  <!-- Footer -->
  <div id="chat-footer">
    <button id="clear-btn" onclick="clearChat()">ğŸ—‘ï¸ Clear Chat</button>
    <div class="powered-by">Powered by <span>CAS</span></div>
  </div>

</div>

<script>
const SHEET_ID = "15nVPABd1lsP507CQeBDyJRrm2qDeiBPE1PeVu_x255s";
const API_KEY = "AIzaSyA9hwrryLxGH9OMSCcnGUNaaxAIfn9t_yE";

let isDark = true;
let isListening = false;
let recognition = null;
let isChatOpen = false;
let currentSheet = "Sheet1";

// â”€â”€ Sound Notification â”€â”€
function playPing() {
  try {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.connect(g);
    g.connect(ctx.destination);
    o.frequency.setValueAtTime(880, ctx.currentTime);
    o.frequency.exponentialRampToValueAtTime(440, ctx.currentTime + 0.15);
    g.gain.setValueAtTime(0.15, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.4);
    o.start(ctx.currentTime);
    o.stop(ctx.currentTime + 0.4);
  } catch(e) {}
}

// â”€â”€ Toast â”€â”€
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// â”€â”€ Toggle Chat â”€â”€
function toggleChat() {
  isChatOpen = !isChatOpen;
  document.getElementById('chatbox').classList.toggle('open', isChatOpen);
  document.getElementById('chat-fab').textContent = isChatOpen ? 'âœ•' : 'ğŸ’¬';
  document.getElementById('notif-badge').classList.add('hidden');
  if (isChatOpen) document.getElementById('question').focus();
}

// â”€â”€ Theme â”€â”€
function toggleDark() {
  isDark = !isDark;
  document.body.classList.toggle('light', !isDark);
  document.getElementById('theme-btn').textContent = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
}

// â”€â”€ Category â”€â”€
function setCategory(btn, sheet) {
  currentSheet = sheet;
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  addMessage(`Switched to <b>${btn.textContent}</b> category!`, 'bot');
}

// â”€â”€ Time â”€â”€
function getTime() {
  return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
}

// â”€â”€ Add Message â”€â”€
let msgCount = 0;
function addMessage(text, sender) {
  const messages = document.getElementById('chat-messages');
  const id = 'msg-' + (++msgCount);
  const row = document.createElement('div');
  row.className = `msg-row ${sender === 'user' ? 'user' : 'bot-row'}`;
  row.id = id;

  const avatarDiv = `<div class="msg-avatar ${sender === 'user' ? 'user-av' : 'bot-av'}">${sender === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–'}</div>`;

  let actionsHTML = '';
  if (sender === 'bot') {
    actionsHTML = `
      <div class="bubble-actions">
        <span class="bubble-time">${getTime()}</span>
        <button class="action-btn" onclick="copyMsg('${id}')" title="Copy">ğŸ“‹</button>
        <button class="action-btn" onclick="likeMsg(this)" title="Good answer">ğŸ‘</button>
        <button class="action-btn" onclick="dislikeMsg(this)" title="Bad answer">ğŸ‘</button>
      </div>`;
  } else {
    actionsHTML = `<div class="bubble-actions"><span class="bubble-time" style="text-align:right;width:100%">${getTime()}</span></div>`;
  }

  const bubbleHTML = `<div class="bubble-wrap"><div class="bubble ${sender}">${text}</div>${actionsHTML}</div>`;

  row.innerHTML = sender === 'user'
    ? `${bubbleHTML}${avatarDiv}`
    : `${avatarDiv}${bubbleHTML}`;

  messages.appendChild(row);
  messages.scrollTop = messages.scrollHeight;
}

// â”€â”€ Copy Message â”€â”€
function copyMsg(id) {
  const row = document.getElementById(id);
  const text = row.querySelector('.bubble').innerText;
  navigator.clipboard.writeText(text).then(() => {
    const btn = row.querySelector('.action-btn');
    btn.classList.add('copied');
    showToast('âœ… Answer copied to clipboard!');
    setTimeout(() => btn.classList.remove('copied'), 2000);
  });
}

// â”€â”€ Feedback â”€â”€
function likeMsg(btn) {
  btn.classList.toggle('liked');
  btn.closest('.bubble-actions').querySelector('.action-btn:last-child').classList.remove('disliked');
  if (btn.classList.contains('liked')) showToast('ğŸ‘ Thanks for the feedback!');
}
function dislikeMsg(btn) {
  btn.classList.toggle('disliked');
  btn.closest('.bubble-actions').querySelector('.action-btn:nth-child(3)').classList.remove('liked');
  if (btn.classList.contains('disliked')) showToast('ğŸ‘ Thanks! We\'ll improve this.');
}

// â”€â”€ Typing â”€â”€
function showTyping() {
  const messages = document.getElementById('chat-messages');
  const row = document.createElement('div');
  row.className = 'msg-row bot-row';
  row.id = 'typing-indicator';
  row.innerHTML = `<div class="msg-avatar bot-av">ğŸ¤–</div><div class="typing-bubble"><span></span><span></span><span></span></div>`;
  messages.appendChild(row);
  messages.scrollTop = messages.scrollHeight;
}
function removeTyping() {
  const el = document.getElementById('typing-indicator');
  if (el) el.remove();
}

// â”€â”€ Ask â”€â”€
async function ask() {
  const input = document.getElementById('question');
  const userInput = input.value.trim();
  if (!userInput) return;

  addMessage(userInput, 'user');
  input.value = '';
  showTyping();

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${currentSheet}?key=${API_KEY}`;

  try {
    const res = await fetch(url);
    await new Promise(r => setTimeout(r, 900 + Math.random() * 500));
    removeTyping();

    if (!res.ok) throw new Error("API failed");

    const data = await res.json();
    if (!data.values) { addMessage("âš ï¸ No data found in this sheet.", 'bot'); return; }

    const rows = data.values;
    let found = "âŒ Sorry, I couldn't find an answer. Try a different category or rephrase!";
    const lower = userInput.toLowerCase();

    for (let i = 1; i < rows.length; i++) {
      const q = rows[i][0]?.toLowerCase() || "";
      if (lower.includes(q) || q.includes(lower)) {
        found = rows[i][1] || "No answer available.";
        break;
      }
    }

    addMessage(found, 'bot');
    playPing();

    // Show badge if chat is closed
    if (!isChatOpen) {
      document.getElementById('notif-badge').classList.remove('hidden');
    }

  } catch (err) {
    removeTyping();
    addMessage("âš ï¸ Error fetching data. Check your connection or API key.", 'bot');
    console.error(err);
  }
}

// â”€â”€ Clear Chat â”€â”€
function clearChat() {
  document.getElementById('chat-messages').innerHTML = '';
  addMessage("ğŸ—‘ï¸ Chat cleared! How can I help you?", 'bot');
}

// â”€â”€ Voice Input â”€â”€
function toggleVoice() {
  const micBtn = document.getElementById('mic-btn');
  if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
    addMessage("âš ï¸ Voice input isn't supported in your browser. Try Chrome!", 'bot');
    return;
  }
  if (isListening) { recognition.stop(); return; }

  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SR();
  recognition.lang = 'en-US';
  recognition.interimResults = false;

  recognition.onstart = () => {
    isListening = true;
    micBtn.classList.add('listening');
    micBtn.textContent = 'ğŸ”´';
  };
  recognition.onresult = e => {
    document.getElementById('question').value = e.results[0][0].transcript;
    ask();
  };
  recognition.onend = () => {
    isListening = false;
    micBtn.classList.remove('listening');
    micBtn.textContent = 'ğŸ¤';
  };
  recognition.onerror = () => {
    isListening = false;
    micBtn.classList.remove('listening');
    micBtn.textContent = 'ğŸ¤';
    addMessage("âš ï¸ Voice input failed. Please try again.", 'bot');
  };
  recognition.start();
}

// â”€â”€ Init â”€â”€
window.onload = () => {
  addMessage("ğŸ‘‹ Hi! I'm your <b>CAS Assistant</b>. Select a category above and ask me anything!", 'bot');
  // Auto-open after 1.5s to showcase widget
  setTimeout(() => {
    isChatOpen = false;
    toggleChat();
  }, 1500);
};
</script>
</body>
</html>
