<script>
const SHEET_ID = "15nVPABd1lsP507CQeBDyJRrm2qDeiBPE1PeVu_x255s";
const API_KEY = "YOUR_NEW_API_KEY_HERE"; // Replace with your new key

async function ask() {
  const questionInput = document.getElementById("question");
  const responseBox = document.getElementById("response");

  if (!questionInput || !responseBox) {
    console.error("Element not found");
    return;
  }

  const userInput = questionInput.value.trim().toLowerCase();

  if (!userInput) {
    responseBox.innerText = "⚠️ Please enter a question.";
    return;
  }

  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Sheet1?key=${API_KEY}`;

  try {
    const res = await fetch(url);
    const data = await res.json();

    console.log("API Data:", data);

    if (!data.values) {
      responseBox.innerText = "⚠️ No data found in sheet.";
      return;
    }

    const rows = data.values;
    let found = "❌ Answer not found.";

    for (let i = 1; i < rows.length; i++) {
      const question = rows[i][0]?.toLowerCase() || "";

      if (userInput.includes(question) || question.includes(userInput)) {
        found = rows[i][1] || "No answer available.";
        break;
      }
    }

    responseBox.innerText = found;

  } catch (error) {
    console.error("Error:", error);
    responseBox.innerText = "⚠️ Error fetching data. Check console.";
  }
}
</script>
